
<beans:bean xmlns="http://www.springframework.org/schema/security"
             xmlns:beans="http://www.springframework.org/schema/beans"
             xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
             xsi:schemaLocation="http://www.springframework.org/schema/beans
           http://www.springframework.org/schema/beans/spring-beans-3.0.xsd
           http://www.springframework.org/schema/security
           http://www.springframework.org/schema/security/spring-security.xsd">



   <http auto-config="true">
       <intercept-url pattern="/login.jsp*" access="isAnonymous()"/>
       <intercept-url pattern="/index" access="isAnonymous()"/>
       <intercept-url pattern="/account*" access="isAnonymous()"/>
       <!--<intercept-url pattern="/**" access="isAuthenticated()"/>-->
       <intercept-url pattern="/admin" access="ADMIN"/>

       <!--Fully configured, the <form-login> element looks like this:
        <form-login
           login-page='/login.html'
           login-processing-url="/perform_login"
           default-target-url="/homepage.html"
           authentication-failure-url="/login.html?error=true"
           always-use-default-target="true"/>-->
       <form-login
               login-page="/login"
               default-target-url="/login.html?msg=success"
               username-parameter="email"
               password-parameter="password"
               authentication-failure-url="/login.html?error=true" />
       <logout logout-success-url="/index.html" />


   </http>




    <authentication-manager alias="authenticationManager">
        <authentication-provider user-service-ref="accountDetailsService"/>
    </authentication-manager>


</beans:bean>